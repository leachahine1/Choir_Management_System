{
    "sourceFile": "ISFM/modules/schoir/controllers/sChoir.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1715095245274,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1715095245274,
            "name": "Commit-0",
            "content": "<?php\r\nif (!defined('BASEPATH')) {\r\n    exit('No direct script access allowed');\r\n}\r\nclass SChoir extends MX_Controller {\r\n    /**\r\n     * This controller is use for add Choir and maintain Choir\r\n     *\r\n     * Maps to the following URL\r\n     * \t\thttp://rehearsalple.com/index.php/SChoir\r\n     * \t- or -  \r\n     * \t\thttp://rehearsalple.com/index.php/SChoir/<method_name>\r\n     */\r\n    function __construct() {\r\n        parent::__construct();\r\n        $this->load->model('Choirmodel');\r\n        if (!$this->ion_auth->logged_in()) {\r\n            redirect('auth/login');\r\n        }\r\n    }\r\n    //This function is useing for add a new Choir and section.\r\n    public function addChoir() {\r\n        if ($this->input->post('submit', TRUE)) {\r\n            $ChoirTitle = $this->input->post('Choir_title', TRUE);\r\n            $group = $this->input->post('group', TRUE);\r\n            if ($this->input->post('group_2', TRUE)) {\r\n                $group = $this->input->post('group', TRUE) . ',' . $this->input->post('group_2', TRUE);\r\n            }\r\n            if ($this->input->post('group_3', TRUE)) {\r\n                $group = $this->input->post('group', TRUE) . ',' . $this->input->post('group_2', TRUE) . ',' . $this->input->post('group_3', TRUE);\r\n            }\r\n            $section = $this->input->post('section', TRUE);\r\n            if ($this->input->post('section_2', TRUE)) {\r\n                $section = $this->input->post('section', TRUE) . ',' . $this->input->post('section_2', TRUE);\r\n            }\r\n            if ($this->input->post('section_3', TRUE)) {\r\n                $section = $this->input->post('section', TRUE) . ',' . $this->input->post('section_2', TRUE) . ',' . $this->input->post('section_3', TRUE);\r\n            }\r\n            if ($this->input->post('section_4', TRUE)) {\r\n                $section = $this->input->post('section', TRUE) . ',' . $this->input->post('section_2', TRUE) . ',' . $this->input->post('section_3', TRUE) . ',' . $this->input->post('section_4', TRUE);\r\n            }\r\n            if ($this->input->post('section_5', TRUE)) {\r\n                $section = $this->input->post('section', TRUE) . ',' . $this->input->post('section_2', TRUE) . ',' . $this->input->post('section_3', TRUE) . ',' . $this->input->post('section_4', TRUE) . ',' . $this->input->post('section_5', TRUE);\r\n            }\r\n            $capicity = $this->input->post('capicity', TRUE);\r\n            $ChoirCode = $this->input->post('Choir_code', TRUE);\r\n            $tableData = array(\r\n                'Choir_title' => $this->db->escape_like_str($ChoirTitle),\r\n                'Choir_group' => $this->db->escape_like_str($group),\r\n                'section' => $this->db->escape_like_str($section),\r\n                'section_Choir_member_capacity' => $this->db->escape_like_str($capicity),\r\n                'ChoirCode' => $this->db->escape_like_str($ChoirCode)\r\n            );\r\n            if ($this->db->insert('Choir', $tableData)) {\r\n                $data['success'] = '<div class=\"alert alert-info alert-dismissable admisionSucceassMessageFont\">\r\n                                            <button aria-hidden=\"true\" data-dismiss=\"alert\" class=\"close\" type=\"button\"></button>\r\n                                            <strong>'.lang('success').'</strong>'.lang('clasc_1').' \"' . $ChoirTitle . '\" '.lang('clasc_2').'\r\n                                    </div>';\r\n                $data['ChoirInfo'] = $this->common->getAllData('Choir');\r\n                $this->load->view('temp/header');\r\n                $this->load->view('allChoir', $data);\r\n                $this->load->view('temp/footer');\r\n            }\r\n        } else {\r\n            $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n            $this->load->view('temp/header');\r\n            $this->load->view('addChoirSection', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n    \r\n    //This function can edit Choir information\r\n    public function deleteChoir() {\r\n        $id = $this->input->get('id');\r\n        if ($this->db->delete('Choir', array('id' => $id))) {\r\n            redirect('sChoir/allChoir/', 'refresh');\r\n        }\r\n    }\r\n    \r\n    //This function is useing for geting all Choir short information\r\n    public function allChoir() {\r\n        $data['ChoirInfo'] = $this->common->getAllData('Choir');\r\n        $this->load->view('temp/header');\r\n        $this->load->view('allChoir', $data);\r\n        $this->load->view('temp/footer');\r\n    }\r\n    \r\n    //This function is useing for a Choir's full informtion\r\n    public function ChoirDetails() {\r\n        $Choir_id = $this->input->get('c_id');\r\n        $data['Choir'] = $this->common->getWhere('Choir', 'id', $Choir_id);\r\n        $data['day'] = $this->common->getAllData('config_week_day');\r\n        $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n        $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n        $data['ChoirSection'] = $this->Choirmodel->totalChoirSection($Choir_id);\r\n        $this->load->view('temp/header');\r\n        $this->load->view('ChoirDetails', $data);\r\n        $this->load->view('temp/footer');\r\n    }\r\n    //This function lode the view for select which Choir routine add or make\r\n    public function selectChoirRoutin() {\r\n        $data['ChoirTile'] = $this->common->getAllData('Choir');\r\n        $data['day'] = $this->common->getAllData('config_week_day');\r\n        $this->load->view('temp/header');\r\n        $this->load->view('selectChoirRoutine', $data);\r\n        $this->load->view('temp/footer');\r\n    }\r\n    //This function is useing for add new Choir routine\r\n    public function addChoirRoutin() {\r\n        $Choir_id = $this->input->post('Choir', TRUE);\r\n        $ChoirTitle = $this->common->Choir_title($Choir_id);\r\n        //if admin set section for any Choir then bellow [if(){ condition]  will execute ***(Start)***\r\n        if ($this->input->post('section', TRUE)) {\r\n            $section = $this->input->post('section', TRUE);\r\n            //if admin set \"all\" section for any Choir then bellow [if(){ condition]  will execute ***(Start)***\r\n            if ($section == 'all') {\r\n                if ($this->input->post('submit2', TRUE)) {\r\n                    $day = $this->input->post('day', TRUE);\r\n                    $song = $this->input->post('song', TRUE);\r\n                    $section_leader = $this->input->post('section_leader', TRUE);\r\n                    $startTime = $this->input->post('startTime', TRUE);\r\n                    $endTime = $this->input->post('endTime', TRUE);\r\n                    $roomNumber = $this->input->post('roomNumber', TRUE);\r\n                    $tableData = array(\r\n                        'Choir_id' => $this->db->escape_like_str($Choir_id),\r\n                        'day_title' => $this->db->escape_like_str($day),\r\n                        'section' => $this->db->escape_like_str($section),\r\n                        'song' => $this->db->escape_like_str($song),\r\n                        'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                        'start_time' => $this->db->escape_like_str($startTime),\r\n                        'end_time' => $this->db->escape_like_str($endTime),\r\n                        'room_number' => $this->db->escape_like_str($roomNumber)\r\n                    );\r\n                    $tableData2 = array(\r\n                        'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                    );\r\n                    if ($this->db->insert('Choir_routine', $tableData) && $this->db->update('Choir_song', $tableData2, array('Choir_id' => $Choir_id, 'song_title' => $song))) {\r\n                        $data['ChoirTile'] = $ChoirTitle;\r\n                        $data['Choir_id'] = $Choir_id;\r\n                        $data['day'] = $this->common->getAllData('config_week_day');\r\n                        $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                        $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                        $this->load->view('temp/header');\r\n                        $this->load->view('addChoirRoutin', $data);\r\n                        $this->load->view('temp/footer');\r\n                    }\r\n                } else {\r\n                    $data['ChoirTile'] = $ChoirTitle;\r\n                    $data['Choir_id'] = $Choir_id;\r\n                    $data['day'] = $this->common->getAllData('config_week_day');\r\n                    $data['song'] = $this->common->getWhere('Choir_song', $Choir_id);\r\n                    $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                    $this->load->view('temp/header');\r\n                    $this->load->view('addChoirRoutin', $data);\r\n                    $this->load->view('temp/footer');\r\n                }\r\n            }\r\n            //if admin set \"Section A or any specific section\" for any Choir then bellow [ealse{ condition]  will execute ***(Start)***\r\n            else {\r\n                if ($this->input->post('submit2', TRUE)) {\r\n                    $day = $this->input->post('day', TRUE);\r\n                    $song = $this->input->post('song', TRUE);\r\n                    $section_leader = $this->input->post('section_leader', TRUE);\r\n                    $startTime = $this->input->post('startTime', TRUE);\r\n                    $endTime = $this->input->post('endTime', TRUE);\r\n                    $roomNumber = $this->input->post('roomNumber', TRUE);\r\n                    $tableData = array(\r\n                        'Choir_id' => $this->db->escape_like_str($Choir_id),\r\n                        'day_title' => $this->db->escape_like_str($day),\r\n                        'section' => $this->db->escape_like_str($section),\r\n                        'song' => $this->db->escape_like_str($song),\r\n                        'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                        'start_time' => $this->db->escape_like_str($startTime),\r\n                        'end_time' => $this->db->escape_like_str($endTime),\r\n                        'room_number' => $this->db->escape_like_str($roomNumber)\r\n                    );\r\n                    $tableData2 = array(\r\n                        'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                    );\r\n                    if ($this->db->insert('Choir_routine', $tableData) && $this->db->update('Choir_song', $tableData2, array('Choir_id' => $Choir_id, 'songtle' => $song))) {\r\n                        $data['ChoirTile'] = $ChoirTitle;\r\n                        $data['Choir_id'] = $Choir_id;\r\n                        $data['day'] = $this->common->getAllData('config_week_day');\r\n                        $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                        $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                        $this->load->view('temp/header');\r\n                        $this->load->view('addChoirRoutin', $data);\r\n                        $this->load->view('temp/footer');\r\n                    }\r\n                } else {\r\n                    $data['ChoirTile'] = $ChoirTitle;\r\n                    $data['Choir_id'] = $Choir_id;\r\n                    $data['day'] = $this->common->getAllData('config_week_day');\r\n                    $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                    $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                    $this->load->view('temp/header');\r\n                    $this->load->view('addChoirRoutin', $data);\r\n                    $this->load->view('temp/footer');\r\n                }\r\n            }\r\n        }\r\n        //if admin do not set section for any Choir then bellow [else{ condition]  will execute ***(Start)***\r\n        else {\r\n            if ($this->input->post('submit2', TRUE)) {\r\n                $day = $this->input->post('day', TRUE);\r\n                $song = $this->input->post('song', TRUE);\r\n                $section_leader = $this->input->post('section_leader', TRUE);\r\n                $startTime = $this->input->post('startTime', TRUE);\r\n                $endTime = $this->input->post('endTime', TRUE);\r\n                $roomNumber = $this->input->post('roomNumber', TRUE);\r\n                $tableData = array(\r\n                    'Choir_id' => $this->db->escape_like_str($Choir_id),\r\n                    'day_title' => $this->db->escape_like_str($day),\r\n                    'song' => $this->db->escape_like_str($song),\r\n                    'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                    'start_time' => $this->db->escape_like_str($startTime),\r\n                    'end_time' => $this->db->escape_like_str($endTime),\r\n                    'room_number' => $this->db->escape_like_str($roomNumber)\r\n                );\r\n                $tableData2 = array(\r\n                    'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                );\r\n                //$this->db->where(array('Choir_title' => $ChoirTitle,'song_title' =>$song));\r\n                if ($this->db->insert('Choir_routine', $tableData) && $this->db->update('Choir_song', $tableData2, array('Choir_id' => $Choir_id, 'song_title' => $song))) {\r\n                    $data['ChoirTile'] = $ChoirTitle;\r\n                    $data['Choir_id'] = $Choir_id;\r\n                    $data['day'] = $this->common->getAllData('config_week_day');\r\n                    $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                    $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                    $this->load->view('temp/header');\r\n                    $this->load->view('addChoirRoutin', $data);\r\n                    $this->load->view('temp/footer');\r\n                }\r\n            } else {\r\n                $data['ChoirTile'] = $ChoirTitle;\r\n                $data['Choir_id'] = $Choir_id;\r\n                $data['day'] = $this->common->getAllData('config_week_day');\r\n                $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                $this->load->view('temp/header');\r\n                $this->load->view('addChoirRoutin', $data);\r\n                $this->load->view('temp/footer');\r\n            }\r\n        }\r\n    }\r\n\r\n    //This function gives us Choir section and Choir info.\r\n    public function ajaxChoirInfo() {\r\n        $Choir_id = $this->input->get('q');\r\n        $query = $this->common->getWhere('Choir', 'id', $Choir_id);\r\n        foreach ($query as $row) {\r\n            $data = $row;\r\n        }\r\n        echo '<input type=\"hidden\" name=\"Choir_title\" value=\"' . $data['id'] . '\">';\r\n        if (!empty($data['section'])) {\r\n            $section = $data['section'];\r\n            $sectionArray = explode(\",\", $section);\r\n            echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\">'.lang('clasc_3').' <span class=\"requiredStar\"> * </span></label>\r\n                        <div class=\"col-md-6\">\r\n                            <select name=\"section\" class=\"form-control\">\r\n                                <option value=\"all\">'.lang('clasc_4').'</option>';\r\n            foreach ($sectionArray as $sec) {\r\n                echo '<option value=\"' . $sec . '\">' . $sec . '</option>';\r\n            }\r\n            echo '</select></div>\r\n                    </div>';\r\n        } else {\r\n            echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\"></label>\r\n                        <div class=\"col-md-6\">\r\n                        <div class=\"alert alert-warning\">\r\n                                <strong>'.lang('clasc_5').'</strong> '.lang('clasc_6').'\r\n                        </div></div></div>';\r\n        }\r\n    }\r\n    //This function check Choir code data type and leanth\r\n    public function ajaxChoirCodeInfo() {\r\n        $ChoirCode = $this->input->get('q');\r\n        if ($ChoirCode <= 99) {\r\n            if ($this->Choirmodel->ChoirCodeCheck($ChoirCode) == TRUE) {\r\n                echo '<input type=\"hidden\" value=\"' . $ChoirCode . '\" name=\"Choir_code\">';\r\n            } else {\r\n                echo ''.lang('clasc_7').' \" ' . $ChoirCode . ' \" '.lang('clasc_8');\r\n            }\r\n        } else {\r\n            echo lang('clasc_9');\r\n        }\r\n    }\r\n    //This function gives a view for serlect Choir routine\r\n    public function selectAllRoutine() {\r\n        $data['ChoirTile'] = $this->common->getAllData('Choir');\r\n        $data['day'] = $this->common->getAllData('config_week_day');\r\n        $this->load->view('temp/header');\r\n        $this->load->view('selectAllRoutine', $data);\r\n        $this->load->view('temp/footer');\r\n    }\r\n    //This function gives a Choir routine after selecting a Choir\r\n    public function allChoirRoutine() {\r\n        if ($this->input->post('submit', TRUE)) {\r\n            $Choir_id = $this->input->post('Choir', TRUE);\r\n            $data['Choir_id'] = $Choir_id;\r\n            $data['day'] = $this->common->getAllData('config_week_day');\r\n            $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n            $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n            $this->load->view('temp/header');\r\n            $this->load->view('viewRoutine', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n    //By this function edit routine previous information \r\n    public function editRoutine() {\r\n        $routinChoirId = $this->input->get('id', TRUE);\r\n        $Choir_id = $this->input->get('Choir', TRUE);\r\n        if ($this->input->post('update', TRUE)) {\r\n            $day = $this->input->post('day', TRUE);\r\n            $song = $this->input->post('song', TRUE);\r\n            $section_leader = $this->input->post('section_leader', TRUE);\r\n            $startTime = $this->input->post('startTime', TRUE);\r\n            $endTime = $this->input->post('endTime', TRUE);\r\n            $roomNumber = $this->input->post('roomNumber', TRUE);\r\n            $tableData = array(\r\n                'day_title' => $this->db->escape_like_str($day),\r\n                'song' => $this->db->escape_like_str($song),\r\n                'song_section_leader' => $this->db->escape_like_str($section_leader),\r\n                'start_time' => $this->db->escape_like_str($startTime),\r\n                'end_time' => $this->db->escape_like_str($endTime),\r\n                'room_number' => $this->db->escape_like_str($roomNumber)\r\n            );\r\n            $this->db->where('id', $routinChoirId);\r\n            if ($this->db->update('Choir_routine', $tableData)) {\r\n                $data['Choir_id'] = $Choir_id;\r\n                $data['day'] = $this->common->getAllData('config_week_day');\r\n                $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n                $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n                $this->load->view('temp/header');\r\n                $this->load->view('viewRoutine', $data);\r\n                $this->load->view('temp/footer');\r\n            }\r\n        } else {\r\n            $data['Choir_id'] = $Choir_id;\r\n            $data['day'] = $this->common->getAllData('config_week_day');\r\n            $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n            $data['previousRoutin'] = $this->common->getWhere('Choir_routine', 'id', $routinChoirId);\r\n            $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n            $this->load->view('temp/header');\r\n            $this->load->view('editRoutine', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n    //By this function we can delet a Choir routine\r\n    public function deleteRoutine() {\r\n        $routinChoirId = $this->input->get('id');\r\n        $Choir_id = $this->input->get('Choir_id');\r\n        if ($this->db->delete('Choir_routine', array('id' => $routinChoirId))) {\r\n            $data['Choir_id'] = $Choir_id;\r\n            $data['day'] = $this->common->getAllData('config_week_day');\r\n            $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n            $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n            $data['message'] = '<div class=\"alert alert-warning alert-dismissable\">\r\n\t\t\t\t\t\t\t\t<button aria-hidden=\"true\" data-dismiss=\"alert\" class=\"close\" type=\"button\"></button>\r\n\t\t\t\t\t\t\t\t<strong>'.lang('clasc_10').'</strong> '.lang('clasc_11').'\r\n\t\t\t\t\t\t\t</div>';\r\n            $this->load->view('temp/header');\r\n            $this->load->view('viewRoutine', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n    //This function will show Choir_member's and section_trainer's own Choir routine\r\n    public function ownChoirRoutin() {\r\n        $data = array();\r\n        $userId = $this->input->get('uisd');\r\n        $query = $this->db->query(\"SELECT Choir_id FROM Choir_member_info WHERE user_id=$userId\");\r\n        foreach ($query->result_array() as $row) {\r\n            $Choir_id = $row['Choir_id'];\r\n        }\r\n        $data['Choir_id'] = $Choir_id;\r\n        $data['day'] = $this->common->getAllData('config_week_day');\r\n        $data['song'] = $this->common->getWhere('Choir_song', 'Choir_id', $Choir_id);\r\n        $data['section_leader'] = $this->common->getAllData('section_leaders_info');\r\n        $this->load->view('temp/header');\r\n        $this->load->view('viewRoutine', $data);\r\n        $this->load->view('temp/footer');\r\n    }\r\n    //This function gives us Choir section and Choir info.\r\n    public function ajaxpromotion() {\r\n        $ChoirTitle = $this->input->get('q');\r\n        $query = $this->common->getWhere('Choir', 'Choir_title', $ChoirTitle);\r\n        foreach ($query as $row) {\r\n            $data = $row;\r\n        }\r\n        echo '<input type=\"hidden\" name=\"Choir\" value=\"' . $ChoirTitle . '\">';\r\n        if (!empty($data['section'])) {\r\n            $section = $data['section'];\r\n            $sectionArray = explode(\",\", $section);\r\n            $i = 0;\r\n            foreach ($sectionArray as $se) {\r\n                $i++;\r\n            }\r\n            for ($a = 1; $a <= $i; $a++) {\r\n                echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\">'.lang('clasc_3').' ' . $a . '<span class=\"requiredStar\"> * </span></label>\r\n                        <div class=\"col-md-6\">\r\n                            <select name=\"section_' . $a . '\" class=\"form-control\" data-validation=\"required\" data-validation-error-msg=\"\">\r\n                                <option value=\"\">'.lang('select').'</option>';\r\n                foreach ($sectionArray as $sec) {\r\n                    echo '<option value=\"' . $sec . '\">' . $sec . '</option>';\r\n                }\r\n                echo '</select></div></div>';\r\n            }\r\n            $b = $a - 1;\r\n            echo '<input type=\"hidden\" name=\"sectionAmount\" value=\"' . $b . '\">';\r\n        } else {\r\n            echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\"></label>\r\n                        <div class=\"col-md-6\">\r\n                        <div class=\"alert alert-warning\">\r\n                                <strong>'.lang('clasc_5').'</strong> '.lang('clasc_6').'\r\n                        </div></div></div>';\r\n        }\r\n    }\r\n    //This function will work for promotion \r\n    public function promotion() {\r\n        if ($this->input->post('submit', TRUE)) {\r\n            $ChoirId = $this->input->post('Choir', TRUE);\r\n            if ($this->Choirmodel->chFiExRe($ChoirId)) {\r\n                $rehearsalId = $this->Choirmodel->chFiExRe($ChoirId);\r\n                $this->Choirmodel->meritList($rehearsalId);\r\n                $nextChoir_id = $this->input->post('nextChoir', TRUE);\r\n                $query = $this->db->query(\"SELECT Choir_member_id,status,maride_list FROM final_result WHERE rehearsal_id='$rehearsalId'\");\r\n                $i = 1;\r\n                $sm = 1;\r\n                foreach ($query->result_array() as $row) {\r\n                    $Choir_memberId = $row['Choir_member_id'];\r\n                    $status = $row['status'];\r\n                    $newRoll = $row['maride_list'];\r\n                    //Here is chacking this Choir_member is pass the rehearsal or not.\r\n                    if ($status == 'Pass') {\r\n                        $section = '';\r\n                        $sectionCap = $this->Choirmodel->sectionCap($ChoirId);\r\n                        $sectionCap2 = $sectionCap * 2;\r\n                        $sectionCap3 = $sectionCap * 3;\r\n                        $sectionCap4 = $sectionCap * 4;\r\n                        $sectionCap5 = $sectionCap * 5;\r\n                        if ($i <= $sectionCap) {\r\n                            $section = $this->input->post('section_1', TRUE);\r\n                        } elseif ($i > $sectionCap && $i <= $sectionCap2) {\r\n                            $section = $this->input->post('section_2', TRUE);\r\n                        } elseif ($i > $sectionCap2 && $i <= $sectionCap3) {\r\n                            $section = $this->input->post('section_3', TRUE);\r\n                        } elseif ($i > $sectionCap3 && $i <= $sectionCap4) {\r\n                            $section = $this->input->post('section_4', TRUE);\r\n                        } elseif ($i > $sectionCap4 && $i <= $sectionCap5) {\r\n                            $section = $this->input->post('section_5', TRUE);\r\n                        }\r\n                        $arrayChoirStud = array(\r\n                            'year' => $this->db->escape_like_str($this->input->post('nextYear', TRUE)),\r\n                            'roll_number' => $this->db->escape_like_str($newRoll),\r\n                            'Choir_id' => $this->db->escape_like_str($nextChoir_id),\r\n                            'Choir_title' => $this->db->escape_like_str($this->common->Choir_title($nextChoir_id)),\r\n                            'section' => $this->db->escape_like_str($section),\r\n                            'attendance_percentices_daily' => $this->db->escape_like_str(0),\r\n                        );\r\n                        $this->db->where('Choir_member_id', $Choir_memberId);\r\n                        if ($this->db->update('Choir_Choir_members', $arrayChoirStud)) {\r\n                            $arrayChoirInfo = array(\r\n                                'Choir_member_amount' => $this->db->escape_like_str($sm),\r\n                                'attendance_percentices_daily' => $this->db->escape_like_str(0),\r\n                                'attend_percentise_yearly' => $this->db->escape_like_str(0)\r\n                            );\r\n                            $this->db->where('id', $nextChoir_id);\r\n                            $this->db->update('Choir', $arrayChoirInfo);\r\n\r\n                            $arrayDormiSeat = array(\r\n                                'Choir' => $this->db->escape_like_str($nextChoir_id),\r\n                                'roll_number' => $this->db->escape_like_str($newRoll)\r\n                            );\r\n                            $this->db->where('Choir', $ChoirTitle);\r\n                            $this->db->update('concert_seat', $arrayDormiSeat);\r\n                            $arraySection_trainersInfo = array(\r\n                                'Choir_id' => $this->db->escape_like_str($nextChoir_id)\r\n                            );\r\n                            $this->db->where('Choir_member_id', $Choir_memberId);\r\n                            $this->db->update('section_trainers_info', $arraySection_trainersInfo);\r\n                            $arrrayStudInfo = array(\r\n                                'year' => $this->db->escape_like_str($this->input->post('nextYear', TRUE)),\r\n                                'roll_number' => $this->db->escape_like_str($newRoll),\r\n                                'Choir_id' => $this->db->escape_like_str($nextChoir_id),\r\n                            );\r\n                            $this->db->where('Choir_member_id', $Choir_memberId);\r\n                            $this->db->update('Choir_member_info', $arrrayStudInfo);\r\n                        }\r\n                        $sm++;\r\n                    }\r\n                    $i++;\r\n                }\r\n                $data['message'] = lang('clasc_12');\r\n                $data['ChoirTile'] = $this->common->getAllData('Choir');\r\n                $this->load->view('temp/header');\r\n                $this->load->view('promotion', $data);\r\n                $this->load->view('temp/footer');\r\n            } else {\r\n                $data['message'] = lang('clasc_13');\r\n                $data['ChoirTile'] = $this->common->getAllData('Choir');\r\n                $this->load->view('temp/header');\r\n                $this->load->view('promotion', $data);\r\n                $this->load->view('temp/footer');\r\n            }\r\n        } else {\r\n            $data['ChoirTile'] = $this->common->getAllData('Choir');\r\n            $this->load->view('temp/header');\r\n            $this->load->view('promotion', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n}\r\n"
        }
    ]
}