{
    "sourceFile": "ISFM/modules/section_trainers/controllers/section_trainers.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1714840506352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1714840506352,
            "name": "Commit-0",
            "content": "<?php\r\ndefined('BASEPATH') OR exit('No direct script access allowed');\r\n\r\nclass Section_trainers extends CI_Controller {\r\n\r\n    function __construct() {\r\n        parent::__construct();\r\n        if (!$this->ion_auth->logged_in()) {\r\n            redirect('auth/login');\r\n        }\r\n    }\r\n\r\n    public function section_trainersInformation() {\r\n        if ($this->input->post('submit', TRUE)) {\r\n            $Choir_id = $this->input->post('Choir_id', TRUE);\r\n            $selected_section = $this->input->post('section', TRUE); // Get selected section name\r\n            $data['Choir_title'] = $this->common->Choir_title($Choir_id);\r\n            $data['selected_section'] = $selected_section; // Pass selected section name to the view\r\n            $data['section_trainers'] = $this->common->getWhere22('section_trainers_info', 'Choir_id', $Choir_id, 'section', $selected_section); // Fetch trainers for the selected section\r\n            $this->load->view('temp/header');\r\n            $this->load->view('section_trainersInformation', $data);\r\n            $this->load->view('temp/footer');\r\n        } else {\r\n            $data['s_Choir'] = $this->common->getAllData('Choir');\r\n            $this->load->view('temp/header');\r\n            $this->load->view('section_trainers', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n\r\n    public function ajaxChoirSection() {\r\n        $Choir_id = $this->input->get('q');\r\n        $query = $this->common->getWhere('Choir', 'id', $Choir_id);\r\n        foreach ($query as $row) {\r\n            $data = $row;\r\n        }\r\n        echo '<input type=\"hidden\" name=\"Choir_title\" value=\"' . $data['id'] . '\">';\r\n        if (!empty($data['section'])) {\r\n            $section = $data['section'];\r\n            $sectionArray = explode(\",\", $section);\r\n            echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\">'.lang('clasc_3').' <span class=\"requiredStar\"> * </span></label>\r\n                        <div class=\"col-md-6\">\r\n                            <select name=\"section\" class=\"form-control\">\r\n                                <option value=\"all\">'.lang('clasc_4').'</option>';\r\n            foreach ($sectionArray as $sec) {\r\n                echo '<option value=\"' . $sec . '\">' . $sec . '</option>';\r\n            }\r\n            echo '</select></div>\r\n                    </div>';\r\n        } else {\r\n            echo '<div class=\"form-group\">\r\n                        <label class=\"col-md-3 control-label\"></label>\r\n                        <div class=\"col-md-6\">\r\n                        <div class=\"alert alert-warning\">\r\n                                <strong>'.lang('clasc_5').'</strong> '.lang('clasc_6').'\r\n                        </div></div></div>';\r\n        }\r\n    }\r\n\r\n    \r\n    //This function will update the section_trainers information.\r\n    public function editSection_trainersInfo() {\r\n        $userID = $this->input->get('puid');\r\n        $section_trainersInfoId = $this->input->get('painid');\r\n        if ($this->input->post('submit', TRUE)) {\r\n            $username = $this->input->post('first_name', TRUE) . ' ' . $this->input->post('last_name', TRUE);\r\n            $additional_data = array(\r\n                'username' => $this->db->escape_like_str($username),\r\n                'first_name' => $this->db->escape_like_str($this->input->post('first_name', TRUE)),\r\n                'last_name' => $this->db->escape_like_str($this->input->post('last_name', TRUE)),\r\n                'phone' => $this->db->escape_like_str($this->input->post('phone', TRUE)),\r\n                'email' => $this->db->escape_like_str($this->input->post('email', TRUE))\r\n            );\r\n            $this->db->where('id', $userID);\r\n            $this->db->update('users', $additional_data);\r\n            $additionalData1 = array(\r\n                'section_trainers_name' => $this->db->escape_like_str($username),\r\n                'level' => $this->db->escape_like_str($this->input->post('guardianLevel', TRUE)),\r\n                'email' => $this->db->escape_like_str($this->input->post('email', TRUE)),\r\n                'phone' => $this->db->escape_like_str($this->input->post('phone', TRUE)),\r\n            );\r\n            $this->db->where('id', $section_trainersInfoId);\r\n            $this->db->update('section_trainers_info', $additionalData1);\r\n            $data['s_Choir'] = $this->common->getAllData('Choir');\r\n            $data['success'] = '<br><div class=\"col-md-12\"><div class=\"alert alert-info alert-dismissable admisionSucceassMessageFont\">\r\n                                                <button aria-hidden=\"true\" data-dismiss=\"alert\" class=\"close\" type=\"button\"></button>\r\n                                                <strong>' . lang('success') . '</strong>' . lang('parc_4') . '\r\n                                        </div></div>';\r\n            $this->load->view('temp/header');\r\n            $this->load->view('section_trainers', $data);\r\n            $this->load->view('temp/footer');\r\n        } else {\r\n            $data['info'] = $this->common->getWhere('section_trainers_info', 'id', $section_trainersInfoId);\r\n            $this->load->view('temp/header');\r\n            $this->load->view('editSection_trainers', $data);\r\n            $this->load->view('temp/footer');\r\n        }\r\n    }\r\n    //This function is using for delete any section_trainers profile.\r\n    public function deleteSection_trainers() {\r\n        $userID = $this->input->get('UcsHeRnHdtfgrfGshId');\r\n        $section_trainersInfoId = $this->input->get('pdfdsfAjhgdfrRdfeNdsfdtSjdcfgdInfOdfgdfhIdnfd');\r\n\r\n        $this->db->delete('users', array('id' => $userID));\r\n        $this->db->delete('section_trainers_info', array('id' => $section_trainersInfoId));\r\n\r\n        redirect(\"section_trainers/section_trainersInformation\", 'refresh');\r\n    }\r\n}"
        }
    ]
}