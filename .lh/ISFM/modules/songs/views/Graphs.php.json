{
    "sourceFile": "ISFM/modules/songs/views/Graphs.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1715171603866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1715171676481,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,36 +40,104 @@\n             'score' => $entry['score']\n         ];\n     }\n }\n-?>\n-<!-- HTML structure and page content -->\n+?><!-- BEGIN CONTENT -->\n <div class=\"page-content-wrapper\">\n     <div class=\"page-content\">\n-        <!-- Page header and breadcrumb -->\n-        <h3 class=\"page-title\"><?php echo lang('sub_set_optional'); ?></h3>\n-        <ul class=\"page-breadcrumb breadcrumb\">\n-            <li><i class=\"fa fa-home\"></i>Home</li>\n-            <li><?php echo lang('sub_song'); ?></li>\n-            <li><?php echo lang('header_ass_opt_sub'); ?></li>\n-            <li id=\"result\" class=\"pull-right topClock\"></li>\n-        </ul>\n+        <!-- BEGIN PAGE HEADER-->\n+        <div class=\"row\">\n+            <div class=\"col-md-12\">\n+                <!-- BEGIN PAGE TITLE & BREADCRUMB-->\n+                <h3 class=\"page-title\">\n+                    <?php echo lang('sub_set_optional'); ?>\n+                </h3>\n+                <ul class=\"page-breadcrumb breadcrumb\">\n+                    <li>\n+                        <i class=\"fa fa-home\"></i>Home\n+                    </li>\n+                    <li>\n+                        <?php echo lang('sub_song'); ?>\n+                    </li>\n+                    <li>\n+                        <?php echo lang('header_ass_opt_sub'); ?>\n+                    </li>\n+                    <li id=\"result\" class=\"pull-right topClock\"></li>\n+                </ul>\n+                <!-- END PAGE TITLE & BREADCRUMB-->\n+            </div>\n+        </div>\n+        <!-- END PAGE HEADER-->\n \n-        <!-- Visualization content -->\n-        <?php foreach ($sequenceCharts as $sequenceName => $info): ?>\n-        <div class=\"portlet box purple\">\n-            <div class=\"portlet-title\">\n-                <div class=\"caption\">\n-                    <i class=\"fa fa-bar-chart\"></i> Bar Chart for <?php echo $sequenceName; ?>\n+        <!-- BEGIN PAGE CONTENT-->\n+        <div class=\"row\">\n+            <?php foreach ($sequenceScores as $sequenceName => $sequence): ?>\n+            <!-- Bar Chart Placeholder -->\n+            <div class=\"col-md-12\">\n+                <div class=\"portlet box purple\">\n+                    <div class=\"portlet-title\">\n+                        <div class=\"caption\">\n+                            <i class=\"fa fa-bar-chart\"></i> Bar Chart for <?php echo $sequenceName; ?> Match Count\n+                        </div>\n+                    </div>\n+                    <div class=\"portlet-body\">\n+                        <div id=\"bar_chart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>\" style=\"width:100%; height:400px;\"></div>\n+                    </div>\n                 </div>\n             </div>\n-            <div class=\"portlet-body\">\n-                <div id=\"bar_chart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>\" style=\"height:400px;\"></div>\n+            <?php endforeach; ?>\n+\n+            <!-- Pie Chart Placeholder -->\n+            <div class=\"col-md-12\">\n+                <div class=\"portlet box purple\">\n+                    <div class=\"portlet-title\">\n+                        <div class=\"caption\">\n+                            <i class=\"fa fa-pie-chart\"></i> Pie Chart for Match Distribution\n+                        </div>\n+                    </div>\n+                    <div class=\"portlet-body\">\n+                    <canvas id=\"pie_chart\" style=\"max-width:400px; max-height:400px;\"></canvas>\n+\n+                    </div>\n+                </div>\n             </div>\n+\n+            <!-- Line Chart Placeholder -->\n+            <div class=\"col-md-12\">\n+                <div class=\"portlet box purple\">\n+                    <div class=\"portlet-title\">\n+                        <div class=\"caption\">\n+                            <i class=\"fa fa-line-chart\"></i> Line Chart for Match Proportion Over Time\n+                        </div>\n+                    </div>\n+                    <div class=\"portlet-body\">\n+                        <div id=\"line_chart\" style=\"width:100%; height:400px;\"></div>\n+                    </div>\n+                </div>\n+            </div>\n+\n+            <!-- Stacked Bar Chart Placeholder -->\n+\n+\n+              <!--  Bar Chart Placeholder -->\n+             <!-- Bar Chart Placeholder -->\n+                <div class=\"col-md-12\">\n+                    <div class=\"portlet box purple\" style=\"background-color: white;\">\n+                        <div class=\"portlet-title\">\n+                            <div class=\"caption\">\n+                                <i class=\"fa fa-bars\"></i> Bar Chart for scores across sequences\n+                            </div>\n+                        </div>\n+                        <div class=\"portlet-body\">\n+                            <canvas id=\"scoresChart\"></canvas>\n+                        </div>\n+                    </div>\n+                </div>\n         </div>\n-        <?php endforeach; ?>\n+        <!-- END PAGE CONTENT-->\n     </div>\n </div>\n+<!-- END CONTENT -->\n \n <!-- Load necessary JavaScript libraries -->\n <script src=\"https://cdn.jsdelivr.net/npm/jquery\"></script>\n <script src=\"https://cdn.jsdelivr.net/npm/jquery.flot\"></script>\n"
                },
                {
                    "date": 1715171746063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,92 @@\n $fileContents = file_get_contents('results.json');\n // Decode JSON data into an associative array\n $data = json_decode($fileContents, true);\n \n+// Initialize an empty array to store sequence scores\n+$sequenceScores = [];\n+\n+// Iterate over each entry in the JSON data\n+foreach ($data as $key => $entry) {\n+    // Check if the entry has both 'score' and 'list' keys\n+    if (isset($entry['score']) && isset($entry['list'])) {\n+        // Create a new sequence with a unique name\n+        $sequenceName = 'Test ' . ($key + 1); // Naming starts from Test 1\n+        // Assign 'data' and 'score' to the new sequence\n+        $sequenceScores[$sequenceName] = [\n+            'data' => $entry['list'],\n+            'score' => $entry['score']\n+        ];\n+    }\n+}\n+\n+// Preparing matches and durations for the Scatter Plot\n+$matches = [];\n+$durations = [];\n+foreach ($sequenceScores as $sequence) {\n+    $duration = rand(1, 100);  // Simulate a duration for the sequence\n+    foreach ($sequence['data'] as $index => $item) {\n+        if ($item === 'Match' || (is_array($item) && in_array('Pitch Match', $item))) {\n+            $matches[] = $index;  // Index as x-coordinate\n+            $durations[] = $duration;  // Simulated duration as y-coordinate\n+        }\n+    }\n+}\n+\n+$counts = [\n+    'Match' => 0,\n+    'No Match' => 0,\n+    'Sliding' => 0,\n+    'Dur. Mismatch' => 0\n+];\n+\n+// Process data for visualization and update counts\n+foreach ($sequenceScores as $sequence) {\n+    foreach ($sequence['data'] as $item) {\n+        if (is_array($item)) {\n+            if (in_array('Pitch Match', $item)) {\n+                $counts['Match']++;\n+            }\n+            if (in_array('Dur. Mismatch', $item)) {\n+                $counts['Dur. Mismatch']++;\n+            }\n+        } else {\n+            $counts[$item]++;\n+        }\n+    }\n+}\n+\n+// Prepare data points for line chart showing cumulative matches over time\n+$dataPoints = [];\n+$sumMatches = 0;\n+foreach ($sequenceScores as $sequence) {\n+    foreach ($sequence['data'] as $item) {\n+        if ($item === 'Match' || (is_array($item) && in_array('Pitch Match', $item))) {\n+            $sumMatches++;\n+        }\n+        $dataPoints[] = $sumMatches;\n+    }\n+}\n+\n+// Calculate Histogram data for durations\n+$bins = array_fill(0, 10, 0);  // 10 bins for example\n+foreach ($durations as $duration) {\n+    $index = floor($duration / 10);  // Determine the bin index\n+    if ($index < 10) {\n+        $bins[$index]++;\n+    }\n+    // echo \"Duration: $duration, Bin Index: $index\\n\";\n+\n+}\n+// var_export($durations);\n+// var_export($bins);\n+\n+?><?php\n+// Read JSON file contents\n+$fileContents = file_get_contents('results.json');\n+// Decode JSON data into an associative array\n+$data = json_decode($fileContents, true);\n+\n // Prepare an array for each sequence with its own match counts\n $sequenceCharts = [];\n \n foreach ($data as $key => $entry) {\n"
                }
            ],
            "date": 1715171603866,
            "name": "Commit-0",
            "content": "<?php\n// Read JSON file contents\n$fileContents = file_get_contents('results.json');\n// Decode JSON data into an associative array\n$data = json_decode($fileContents, true);\n\n// Prepare an array for each sequence with its own match counts\n$sequenceCharts = [];\n\nforeach ($data as $key => $entry) {\n    if (isset($entry['score']) && isset($entry['list'])) {\n        // Initialize counts for each sequence\n        $counts = [\n            'Match' => 0,\n            'No Match' => 0,\n            'Sliding' => 0,\n            'Dur. Mismatch' => 0\n        ];\n\n        // Process each item in the list to update counts\n        foreach ($entry['list'] as $item) {\n            if (is_array($item)) {\n                foreach ($item as $subItem) {\n                    if ($subItem === 'Pitch Match') {\n                        $counts['Match']++;\n                    } elseif ($subItem === 'Dur. Mismatch') {\n                        $counts['Dur. Mismatch']++;\n                    }\n                }\n            } else {\n                if (isset($counts[$item])) {\n                    $counts[$item]++;\n                }\n            }\n        }\n\n        // Store each sequence's counts and score\n        $sequenceCharts['Test ' . ($key + 1)] = [\n            'counts' => $counts,\n            'score' => $entry['score']\n        ];\n    }\n}\n?>\n<!-- HTML structure and page content -->\n<div class=\"page-content-wrapper\">\n    <div class=\"page-content\">\n        <!-- Page header and breadcrumb -->\n        <h3 class=\"page-title\"><?php echo lang('sub_set_optional'); ?></h3>\n        <ul class=\"page-breadcrumb breadcrumb\">\n            <li><i class=\"fa fa-home\"></i>Home</li>\n            <li><?php echo lang('sub_song'); ?></li>\n            <li><?php echo lang('header_ass_opt_sub'); ?></li>\n            <li id=\"result\" class=\"pull-right topClock\"></li>\n        </ul>\n\n        <!-- Visualization content -->\n        <?php foreach ($sequenceCharts as $sequenceName => $info): ?>\n        <div class=\"portlet box purple\">\n            <div class=\"portlet-title\">\n                <div class=\"caption\">\n                    <i class=\"fa fa-bar-chart\"></i> Bar Chart for <?php echo $sequenceName; ?>\n                </div>\n            </div>\n            <div class=\"portlet-body\">\n                <div id=\"bar_chart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>\" style=\"height:400px;\"></div>\n            </div>\n        </div>\n        <?php endforeach; ?>\n    </div>\n</div>\n\n<!-- Load necessary JavaScript libraries -->\n<script src=\"https://cdn.jsdelivr.net/npm/jquery\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery.flot\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/flot/4.2.6/jquery.flot.categories.min.js\"></script>\n\n<script>\njQuery(document).ready(function() {\n    <?php foreach ($sequenceCharts as $sequenceName => $info): ?>\n    // Function to update bar chart for each sequence\n    function updateBarChart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>() {\n        var barData = [\n            { label: \"Match\", data: [[1, <?php echo $info['counts']['Match']; ?>]], color: \"#8A2BE2\" },\n            { label: \"No Match\", data: [[2, <?php echo $info['counts']['No Match']; ?>]], color: \"#DA70D6\" },\n            { label: \"Sliding\", data: [[3, <?php echo $info['counts']['Sliding']; ?>]], color: \"#9370DB\" },\n            { label: \"Duration Mismatch\", data: [[4, <?php echo $info['counts']['Dur. Mismatch']; ?>]], color: \"#D8BFD8\" }\n        ];\n        var options = {\n            series: {\n                bars: { show: true, barWidth: 0.5, align: 'center' }\n            },\n            xaxis: { mode: 'categories', tickLength: 0 },\n            yaxis: {},\n            grid: { hoverable: true, clickable: true, borderWidth: 1, borderColor: '#ccc' },\n            legend: { show: true, position: \"ne\" }\n        };\n        $.plot('#bar_chart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>', barData, options);\n    }\n    updateBarChart_<?php echo str_replace(' ', '_', strtolower($sequenceName)); ?>();\n    <?php endforeach; ?>\n});\n</script>\n\n\n<script>\njQuery(document).ready(function() {\n    function updatePieChart() {\n        var data = {\n            labels: ['Match', 'No Match', 'Sliding', 'Duration Mismatch'],\n            datasets: [{\n                data: [<?php echo $counts['Match']; ?>, <?php echo $counts['No Match']; ?>, <?php echo $counts['Sliding']; ?>, <?php echo $counts['Dur. Mismatch']; ?>],\n                backgroundColor: ['#8D83BF', '#B9ADD5', '#dcd4e9', '#693b69'],\n                borderColor: ['#8D83BF', '#B9ADD5', '#dcd4e9', '#693b69'],\n                borderWidth: 1\n            }]\n        };\n\n        var ctx = document.getElementById('pie_chart').getContext('2d');\n        var pieChart = new Chart(ctx, {\n            type: 'pie',\n            data: data,\n            options: {\n                responsive: false,\n                legend: {\n                    position: 'top',\n                },\n                title: {\n                    display: true,\n                    text: 'Match Distribution'\n                },\n                plugins: {\n                    datalabels: {\n                        display: true,\n                        formatter: function(value) {\n                            return value + '%';\n                        }\n                    }\n                }\n            }\n        });\n    }\n    updatePieChart();\n});\n</script>\n\n<script>\n    jQuery(document).ready(function() {\n        function updateLineChart() {\n            // Data points for the line chart\n            var dataPoints = <?php echo json_encode($dataPoints); ?>;\n            // Prepare the data in the format required by Flot\n            var data = [{\n                label: \"Match Count Over Time\",\n                data: dataPoints.map(function(value, index) {\n                    return [index + 1, value]; // Assuming time starts from 1\n                }),\n                color: \"#8A2BE2\"\n            }];\n            // Options for the line chart\n            var options = {\n                series: {\n                    lines: { show: true, fill: true },\n                    points: { show: true }\n                },\n                grid: {\n                    hoverable: true,\n                    clickable: true,\n                    borderWidth: 1,\n                    borderColor: '#ccc'\n                },\n                xaxis: {\n                    tickDecimals: 0,\n                    tickSize: 1,\n                    label: \"Time\"\n                },\n                yaxis: {\n                    min: 0,\n                    tickSize: 1,\n                    label: \"Matches\"\n                },\n                legend: {\n                    show: true\n                }\n            };\n            // Plot the line chart\n            $.plot(\"#line_chart\", data, options);\n        }\n        // Call the function to update the line chart\n        updateLineChart();\n    });\n</script>\n\n<!-- JavaScript code to generate the bar chart using Chart.js -->\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n<script>\n    // Retrieve data for scores across sequences\n    var sequenceScores = <?php echo json_encode($sequenceScores); ?>;\n\n    // Extract sequence names and scores\n    var sequenceNames = Object.keys(sequenceScores);\n    var scores = sequenceNames.map(function(sequenceName) {\n        return sequenceScores[sequenceName].score;\n    });\n\n    // Set up the bar chart data\n    var barChartData = {\n        labels: sequenceNames, // Sequence names as labels\n        datasets: [{\n            label: 'Scores',\n            backgroundColor: '#693b69', // Blue color with opacity\n            borderColor: '#693b69',\n            borderWidth: 1,\n            data: scores // Scores as data points\n        }]\n    };\n\n    // Set up options for the bar chart\n    var barChartOptions = {\n        scales: {\n            yAxes: [{\n                ticks: {\n                    beginAtZero: true // Start y-axis from 0\n                },\n                scaleLabel: {\n                    display: true,\n                    labelString: 'Score' // Y-axis label\n                }\n            }],\n            xAxes: [{\n                scaleLabel: {\n                    display: true,\n                    labelString: 'Test' // X-axis label\n                }\n            }]\n        },\n        legend: {\n            display: false // Hide legend\n        }\n    };\n\n    // Get the canvas element\n    var ctx = document.getElementById('scoresChart').getContext('2d');\n\n    // Create the bar chart\n    var scoresChart = new Chart(ctx, {\n        type: 'bar', // Bar chart type\n        data: barChartData,\n        options: barChartOptions\n    });\n</script>\n"
        }
    ]
}